<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Esem√©ny Id≈ëk√∂vet≈ë</title>
  <style>
    /* Theme variables */
    :root {
      --bg-color: #1a1a1a;
      --text-color: #f0f0f0;
      --button-bg: #2d2d2d;
      --button-hover: #3d3d3d;
      --progress-bg: #333;
      --progress-fill: #4caf50;
      --disabled-bg: #444;
    }
    
    [data-theme="light"] {
      --bg-color: #f4f4f4;
      --text-color: #222;
      --button-bg: #007bff;
      --button-hover: #0056b3;
      --progress-bg: #d0d0d0;
      --progress-fill: #28a745;
      --disabled-bg: #888;
    }
    
    /* ‚Äì‚Äì alapelrendez√©s √©s tipogr√°fia ‚Äì‚Äì */
    html,body{margin:0;height:100%;font-family:Arial,Helvetica,sans-serif;background:var(--bg-color);color:var(--text-color);display:flex;flex-direction:column;transition: background-color 0.3s, color 0.3s;}
    #current-item{flex:1 1 auto;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:0 5vw}
    #item-title{font-size:6vw;font-weight:600;line-height:1.1;word-break:break-word}
    #timer{font-size:14vw;font-weight:700;margin-top:0.1em}
    .progress-bar{width:80%;height:1.2vh;background:var(--progress-bg);border-radius:6px;overflow:hidden;margin-top:2vh}
    .progress{height:100%;background:var(--progress-fill);width:0%}
    .controls,.upcoming{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;padding:15px 5vw}
    button{padding:10px 22px;font-size:1rem;border:none;border-radius:6px;cursor:pointer;background:var(--button-bg);color:#fff;transition: background-color 0.2s;}
    button:hover:not(:disabled){background:var(--button-hover);}
    button:disabled{background:var(--disabled-bg);cursor:not-allowed}
    .top-buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 8px;
    }
    #theme-toggle, #fullscreen-btn {
      padding: 8px 12px;
      border-radius: 20px;
      border: none;
      background: var(--button-bg);
      color: #fff;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    #theme-toggle:hover, #fullscreen-btn:hover {
      background: var(--button-hover);
    }
    h2{text-align:center;margin:0.5em 0 0.2em}
    .upcoming-item{margin:3px 0}
    @media(max-width:600px){#item-title{font-size:8vw}#timer{font-size:18vw}}
  </style>
</head>
<body>

  <div id="current-item">
    <div id="item-title">Bet√∂lt√©s‚Ä¶</div>
    <div id="timer">00:00</div>
    <div class="progress-bar"><div class="progress" id="progress"></div></div>
  </div>

  <div class="top-buttons">
    <button id="theme-toggle" onclick="toggleTheme()">üåô</button>
    <button id="fullscreen-btn" onclick="toggleFullscreen()">‚õ∂</button>
  </div>
  
  <div class="controls">
    <button onclick="previousItem()">‚èÆ El≈ëz≈ë</button>
    <button onclick="toggleTimer()" id="playPauseBtn">‚ñ∂ Ind√≠t√°s</button>
    <button onclick="nextItem()">‚è≠ K√∂vetkez≈ë</button>
    <button onclick="resetCurrentTimer()" title="Aktu√°lis id≈ëz√≠t≈ë √∫jraind√≠t√°sa"> √öjraind√≠t</button>
    <button onclick="adjustTime(1)">+1 perc</button>
    <button onclick="adjustTime(-1)">‚àí1 perc</button>
  </div>

  <h2>K√∂vetkez≈ë programpontok</h2>
  <div class="upcoming" id="upcoming-list"></div>

  <script>
    /* ‚Äì‚Äì PROGRAMT√ÅBLA: A felhaszn√°l√≥ √°ltal megadott menetrend ‚Äì‚Äì */
    const agenda = [
      { startTime:"19:45", title:"√âNEK ‚Äì Csisz√©r L√°szl√≥",                                   duration:15 },
      { startTime:"20:00", title:"K√ñSZ√ñNT√âS - M√°rton J√≥zsef f≈ëesperes", duration:10 },
      { startTime:"20:10", title:"TAN√öS√ÅGT√âTELEK ‚Äì Gergely D√°vid √©s T√≥th J√°cinta",          duration:30 },
      { startTime:"20:40", title:"√âNEK ‚Äì Csisz√©r L√°szl√≥",                                   duration:10 },
      { startTime:"20:50", title:"BESZ√âLGET√âS A P√úSP√ñK ATY√ÅVAL", duration:30 },
      { startTime:"21:20", title:"√âNEK ‚Äì Csisz√©r L√°szl√≥",                                   duration:10 },
      { startTime:"21:30", title:"SZENTS√âGIM√ÅD√ÅS ",   duration:45 },
      { startTime:"22:15", title:"√âNEK ‚Äì DICS≈ê√çT√âS / IMA ‚Äì GY√ìNTAT√ÅS ", duration:45 },
      { startTime:"23:00", title:"AGAP√â ‚Äì sz√ºl≈ëk",                                          duration:60 } // m√≥dos√≠that√≥
    ];



    /* ‚Äì‚Äì √Ållapot ‚Äì‚Äì */
    let currentIndex = 0;
    let remainingSeconds = agenda[0].duration * 60;
    let timer = null;
    let isRunning = false;
    
    /* ‚Äì‚Äì T√©ma kezel√©se ‚Äì‚Äì */
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      document.getElementById('theme-toggle').textContent = theme === 'light' ? 'üåô' : '‚òÄÔ∏è';
    }
    
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      setTheme(newTheme);
    }
    
    // Alap√©rtelmezett t√©ma be√°ll√≠t√°sa (s√∂t√©t m√≥d)
    const savedTheme = localStorage.getItem('theme') || 'dark';
    setTheme(savedTheme);

    /* ‚Äì‚Äì Fullscreen funkci√≥ ‚Äì‚Äì */
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        // Enter fullscreen
        if (document.documentElement.requestFullscreen) {
          document.documentElement.requestFullscreen();
        } else if (document.documentElement.webkitRequestFullscreen) { // Safari
          document.documentElement.webkitRequestFullscreen();
        } else if (document.documentElement.msRequestFullscreen) { // IE11
          document.documentElement.msRequestFullscreen();
        }
      } else {
        // Exit fullscreen
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) { // Safari
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) { // IE11
          document.msExitFullscreen();
        }
      }
    }

    // Update fullscreen button icon based on fullscreen state
    document.addEventListener('fullscreenchange', updateFullscreenButton);
    document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
    document.addEventListener('mozfullscreenchange', updateFullscreenButton);
    document.addEventListener('MSFullscreenChange', updateFullscreenButton);

    function updateFullscreenButton() {
      const fullscreenBtn = document.getElementById('fullscreen-btn');
      if (document.fullscreenElement || 
          document.webkitFullscreenElement || 
          document.mozFullScreenElement ||
          document.msFullscreenElement) {
        fullscreenBtn.textContent = '‚õ∂';
      } else {
        fullscreenBtn.textContent = '‚õ∂';
      }
    }

    /* ‚Äì‚Äì Megjelen√≠t√©s ‚Äì‚Äì */
    function render() {
      const item = agenda[currentIndex];
      const timerElement = document.getElementById("timer");
      document.getElementById("item-title").innerText = item.title;
      timerElement.innerText = formatTime(remainingSeconds);
      // Change text color to red when 1 minute or less remains
      if (remainingSeconds <= 60) {
        timerElement.style.color = '#ff6b6b';
      } else {
        timerElement.style.color = '';
      }
      const pct = ((item.duration * 60 - remainingSeconds) / (item.duration * 60)) * 100;
      document.getElementById("progress").style.width = pct + "%";

      const list = document.getElementById("upcoming-list");
      list.innerHTML = '';
      for (let i = currentIndex + 1; i < agenda.length; i++) {
        const div = document.createElement("div");
        div.className = "upcoming-item";
        div.textContent = `‚Ä¢ ${agenda[i].title} (${agenda[i].duration} perc)`;
        list.appendChild(div);
      }
    }

    /* ‚Äì‚Äì Seg√©df√ºggv√©nyek ‚Äì‚Äì */
    const formatTime = s => `${String(Math.floor(s / 60)).padStart(2,'0')}:${String(s % 60).padStart(2,'0')}`;

    /* ‚Äì‚Äì Lej√°tsz√°s / sz√ºnet ‚Äì‚Äì */
    function toggleTimer() {
      if (isRunning) { stopTimer(); return; }
      timer = setInterval(() => {
        if (remainingSeconds > 0) { 
          remainingSeconds--; 
          render(); 
        } else { 
          stopTimer();
          // Flash the screen briefly to indicate time's up
          document.body.style.transition = 'background 0.5s';
          document.body.style.background = '#ffebee';
          setTimeout(() => {
            document.body.style.background = '#f4f4f4';
            // Move to next item after the flash
            if (currentIndex < agenda.length - 1) {
              nextItem();
              // Auto-start the next timer
              if (!isRunning) toggleTimer();
            }
          }, 500);
        }
      }, 1000);
      isRunning = true;
      document.getElementById("playPauseBtn").innerText = "‚è∏ Sz√ºnet";
    }
    function stopTimer() { clearInterval(timer); isRunning=false; document.getElementById("playPauseBtn").innerText="‚ñ∂ Ind√≠t√°s"; }

    /* ‚Äì‚Äì Navig√°ci√≥ ‚Äì‚Äì */
    function nextItem() {
      if (currentIndex < agenda.length - 1) {
        currentIndex++; 
        remainingSeconds = agenda[currentIndex].duration * 60; 
        stopTimer(); 
        render();
        // Auto-start the timer when moving to next item
        if (!isRunning) toggleTimer();
      }
    }
    function previousItem() {
      if (currentIndex > 0) {
        currentIndex--; 
        remainingSeconds = agenda[currentIndex].duration * 60; 
        stopTimer(); 
        render();
        // Auto-start the timer when moving to previous item
        if (!isRunning) toggleTimer();
      }
    }

    /* ‚Äì‚Äì Id≈ë¬†√°ll√≠t√°s ‚Äì‚Äì */
    function adjustTime(mins) { remainingSeconds = Math.max(0, remainingSeconds + mins * 60); render(); }
    
    /* ‚Äì‚Äì √öjraind√≠t√°s ‚Äì‚Äì */
    function resetCurrentTimer() {
      stopTimer();
      remainingSeconds = agenda[currentIndex].duration * 60;
      render();
    }

    render();
  </script>
</body>
</html>
